String.prototype.replaceAll=function(b,a){return this.replace(new RegExp(b,"gm"),a);};function trim(a){var c=a+"";if(c.length==0){return c;}var b=/^\s*/;c=c.replace(b,"");b=/\s*$/;return c.replace(b,"");}function isNull(a){if(trim(a)==""||a=="null"||a=="undefined"||typeof(a)=="undefined"){return true;}return false;}function isDate(c){var e=c;var b,d,a;if(e.indexOf("-")>-1){b=e.substr(0,e.indexOf("-"));}else{return false;}e=e.substr(e.indexOf("-")+1);if(e.indexOf("-")>-1){d=e.substr(0,e.indexOf("-"));}else{return false;}e=e.substr(e.indexOf("-")+1);a=e.substr(0);if(checkday(a,d,b)){return true;}else{return false;}}function isIDCard(a){var g=0;var h="";var b=a;var f={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"***",71:"台湾",81:"香港",82:"澳门",91:"国外"};if(!/^\d{17}(\d|x)$/i.test(b)){return false;}b=b.replace(/x$/i,"a");if(f[parseInt(b.substr(0,2))]==null){return false;}var e=b.substr(6,4)+"-"+Number(b.substr(10,2))+"-"+Number(b.substr(12,2));var j=new Date(e.replace(/-/g,"/"));if(e!=(j.getFullYear()+"-"+(j.getMonth()+1)+"-"+j.getDate())){return false;}for(var c=17;c>=0;c--){g+=(Math.pow(2,c)%11)*parseInt(b.charAt(17-c),11);}if(g%11!=1){return false;}return true;}function isMatchReg(b,a){if(!reg.test(a)){return false;}else{return true;}}function getObj_1(a){if(typeof(a)=="string"){if(a.indexOf("[")>-1){temp_=a.split(".");temp__=temp_[1].substr(temp_[1].indexOf(",")+1,temp_[1].length-temp_[1].indexOf(",")-2);obj_=$(temp_[0]).eq(temp__-1);}else{obj_=$("#"+a);}}if(typeof(a)=="object"){obj_=a;}return obj_;}function Validata_(name_,validateStr_,title_){if(validateStr_.substr(0,1)=="["){var obj_1=eval(validateStr_);validateStr_="";for(var i=0;i<obj_1.length;i++){if(!isNull(obj_1[i].ruleName)){validateStr_+=obj_1[i].ruleName+":";}if(!isNull(obj_1[i].param)){validateStr_+=obj_1[i].param+":";}if(!isNull(obj_1[i].msg)){validateStr_+=obj_1[i].msg+":";}if(!isNull(obj_1[i].fun)){validateStr_+=obj_1[i].fun+":";}}}obj_=getObj_1(name_);var msg_="";var validates_=validateStr_.split(";");for(var i=0;i<validates_.length;i++){var validates_1=validates_[i].split(":");if(!isNull(validates_1[0])){validates_1[0]=validates_1[0].toUpperCase();if(validates_1[0].indexOf("FUN")>-1){reg=eval(validates_1[1]);if(!reg){msg_+="值不符合函数要求";}}if(validates_1[0].indexOf("REGEX")>-1){reg=eval(validates_1[1]);if(!isMatchReg(reg,obj_.val())){msg_+="值不符合表达式要求";}}if(validates_1[0]=="ISA"){reg=/^[A-Za-z]*$/;if(!isMatchReg(reg,obj_.val())){msg_+="值需由字母组成";}}if(validates_1[0]=="ISFILENAME"){reg=/^((\w+)(\.{1})(\w+))$/;if(!isMatchReg(reg,obj_.val())){msg_+="值不符合文件名格式";}}if(validates_1[0]=="ISURI"){reg=/^http:\/\/[a-zA-Z0-9]+\.[a-zA-Z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/;if(!isMatchReg(reg,obj_.val())){msg_+="值不符合inernet地址格式";}}if(validates_1[0]=="ISZIPCODE"){reg=/^[\\d]{6}$/;if(!isMatchReg(reg,obj_.val())){msg_+="值不符合邮编格式";}}if(validates_1[0]=="ISTELEPHONE"){reg=/^(\d{3,4}\-)?[1-9]\d{6,7}$/;if(!isMatchReg(reg,obj_.val())){msg_+="值不符合电话号码格式";}}if(validates_1[0]=="ISMOBILE"){reg=/^(\+\d{2,3}\-)?\d{11}$/;if(!isMatchReg(reg,obj_.val())){msg_+="值不符合移动电话格式";}}if(validates_1[0]=="ISIDCARD"){if(!isIDCard(obj_.val())){msg_+="值不符合身份证格式";}}if(validates_1[0]=="EQUALTO"){reg=validates_1[1];if(reg.substr(0,1)=="$"){reg=eval(reg);}if(typeof(reg)=="object"){if(obj_.val()!=reg.val()){msg_+="值与指定的值不相同";}}if(typeof(reg)=="string"){if(obj_.val()!=reg){msg_+="值与指定的值不相同";}}}if(validates_1[0]=="ISDATETIME"){reg=/^(1|2\d{3}-((0[1-9])|(1[0-2]))-((0[1-9])|([1-2][0-9])|(3([0|1]))))( (\d{2}):(\d{2}):(\d{2}))?$/;if(!isMatchReg(reg,obj_.val())){msg_+="值不符合日期时间格式";}}if(validates_1[0]=="ISDATE"){if(isNull(validates_1[1])||trim(validates_1[1])=="true"){if(!isDate(obj_.val())){msg_+="值不符合日期格式";}}}if(validates_1[0]=="ISEMAIL"){reg=/^[\-!#\$%&'\*\+\\\.\/0-9=\?A-Z\^_`a-z{|}~]+@[\-!#\$%&'\*\+\\\.\/0-9=\?A-Z\^_`a-z{|}~]+(\.[\-!#\$%&'\*\+\\\.\/0-9=\?A-Z\^_`a-z{|}~]+)+$/;if(!isMatchReg(reg,obj_.val())){msg_+="值不符合邮箱格式";}}if(validates_1[0]=="ISNUMBER"){reg=/^[\-\+]?([0-9]\d*|0|[1-9]\d{0,2}(,\d{3})*)(\.\d+)?$/;if(!isMatchReg(reg,obj_.val())){msg_+="值必须为数字";}}if(validates_1[0]=="ISINT"){reg=/(^(0|\-?[1-9]{1}\d*)$)|(^$)/;if(!isMatchReg(reg,obj_.val())){msg_+="值必须为整数";}}if(validates_1[0]=="ISNOTNULL"){if(isNull(validates_1[1])||trim(validates_1[1])=="true"){if(isNull(obj_.val())){msg_+="值不能为空";}}}if(validates_1[0]=="SIZE"){if(!isNull(obj_.val())){var param_1=validates_1[1].split("-");if(!isNull(param_1[0])){if(obj_.val().length<parseInt(param_1[0])){msg_+="长度不能小于"+param_1[0];}}if(!isNull(param_1[1])){if(obj_.val().length>parseInt(param_1[1])){msg_+="长度不能大于"+param_1[1];}}}}if(validates_1[0]=="VALUE"){if(!isNull(obj_.val())){var param_1=validates_1[1].split("-");if(!isNull(param_1[0])){try{if(obj_.val()<parseInt(param_1[0])){msg_+="值不能小于"+param_1[0];}}catch(e){}}if(!isNull(param_1[1])){try{if(obj_.val()>parseInt(param_1[1])){msg_+="值不能大于"+param_1[1];}}catch(e){}}}}if(!isNull(msg_)&&!isNull(validates_1[2])){msg_=validates_1[2];}if(!isNull(msg_)){break;}}}if(!isNull(msg_)){try{if(!isNull(obj_.attr("title"))){msg_=obj_.attr("title");}if(!isNull(title_)&&title_!=null){msg_=title_;obj_.attr("title",title_);}poshytip_init_(name_,msg_);obj_.poshytip("show");}catch(e){alert(msg_);}return msg_;}else{try{obj_.poshytip("hide");}catch(e){}try{eval(validates_1[3]);}catch(e){}return"";}}function poshytip_init_(b,a){b=getObj_1(b);try{b.poshytip("destroy");}catch(c){}b.poshytip({className:"tip-yellowsimple",content:a,showOn:"none",alignTo:"target",alignX:"right",alignY:"center",offsetX:5});}function ValidataClass_(){this.size=0;this.Json="";this.init=function(){this.size=0;this.Json="";};this.add=function(name_,rule_,title_){obj_=getObj_1(name_);if(isNull(obj_.attr("id"))){name_=JSON.stringify(name_);name_=JSON.parse(name_).selector;}else{name_=obj_.attr("id");}this.size=this.size+1;if(this.size!=1){this.Json+=",";}this.Json+="{";if(!isNull(trim(name_))){this.Json+='"id":"'+trim(name_)+'"';}if(!isNull(trim(rule_))){if(trim(rule_).substr(0,1)=="{"||trim(rule_).substr(0,1)=="["){this.Json+=',"rules":'+trim(rule_);}else{this.Json+=',"rules":"'+trim(rule_)+'"';}}if(!isNull(trim(title_))){this.Json+=',"title":"'+trim(title_)+'"';}this.Json+="}";};this.remove=function(name_){obj_=getObj_1(name_);name_=obj_.attr("id");this.size=this.size-1;var startIndex_=this.Json.indexOf('"id":"'+name_);var endIndex_=this.Json.indexOf('"id":"',startIndex_+6);this.Json=this.Json.substr(0,startIndex_)+this.Json.substr(endIndex_,this.Json.length);};this.get=function(name_){obj_=getObj_1(name_);name_=obj_.attr("id");var startIndex_=this.Json.indexOf('"id":"'+name_);var endIndex_=this.Json.indexOf('"id":"',startIndex_+6);if(startIndex_<0){return"";}if(endIndex_<0){return this.Json.substr(startIndex_-1,this.Json.length);}return this.Json.substr(startIndex_-1,endIndex_-2);};this.getRuleObj=function(name_){return eval("("+this.get(name_)+")");};this.isEmpty=function(){if(this.size>0){return true;}return false;};this.toString=function(){return"["+this.Json+"]";};}function ValidateRulaClass_(){this.size=0;this.Json="";this.init=function(json_){this.size=0;this.Json="";if(!isNull(json_)){if(json_.substr(0,1)=="{"){var subobj_=eval("("+json_+")");this.add(subobj_.ruleName,subobj_.param,subobj_.msg,subobj_.fun);}else{if(json_.substr(0,1)=="["){var obj_=eval("("+json_+")");for(var i=0;i<obj_.length;i++){this.add(obj_[i].ruleName,obj_[i].param,obj_[i].msg,obj_[i].fun);}}else{var obj_=json_.split(";");for(var i=0;i<obj_.length;i++){this.add(obj_[i].split(":")[0],obj_[i].split(":")[1],obj_[i].split(":")[2],obj_[i].split(":")[3]);}}}}};this.add=function(name_,param_,msg_,callbakfun_){this.size=this.size+1;if(this.size!=1){this.Json+=",";}this.Json+="{";try{name_=name_.replaceAll('"',"'");}catch(e){}try{param_=param_.replaceAll('"',"'");}catch(e){}try{msg_=msg_.replaceAll('"',"'");}catch(e){}try{callbakfun_=callbakfun_.replaceAll('"',"'");}catch(e){}if(!isNull(trim(name_))){this.Json+='"ruleName":"'+trim(name_).toUpperCase()+'"';}if(!isNull(trim(param_))){if(trim(param_)=="true"||trim(param_)=="false"||trim(param_).substr(0,1)=="{"||trim(param_).substr(0,1)=="["){this.Json+=',"param":'+trim(param_);}else{this.Json+=',"param":"'+trim(param_)+'"';}}if(!isNull(trim(msg_))){this.Json+=',"msg":"'+trim(msg_)+'"';}if(!isNull(trim(callbakfun_))){this.Json+=',"fun":"'+trim(callbakfun_)+'"';}this.Json+="}";};this.remove=function(name_){this.size=this.size-1;var startIndex_=this.Json.indexOf('"ruleName":"'+name_.toUpperCase());var endIndex_=this.Json.indexOf('"ruleName":"',startIndex_+12);this.Json=this.Json.substr(0,startIndex_)+this.Json.substr(endIndex_,this.Json.length);};this.get=function(name_){var startIndex_=this.Json.indexOf('"ruleName":"'+name_.toUpperCase());var endIndex_=this.Json.indexOf('"ruleName":"',startIndex_+12);if(startIndex_<0){return"";}if(endIndex_<0){return this.Json.substr(startIndex_-1,this.Json.length);}return this.Json.substr(startIndex_-1,endIndex_-2);};this.getRuleObj=function(name_){return eval("("+this.get(name_)+")");};this.isEmpty=function(){if(this.size>0){return true;}return false;};this.toString=function(){return"["+this.Json+"]";};}var ValidateRulaClass_instance_=new ValidateRulaClass_();var ValidataClass_instance_=new ValidataClass_();function inputKeyUp_(b,e,d,c){if(isNull(c)){if(typeof(b)=="object"){if(b.length==1){b.keyup(function(){return Validata_(b,e,d);});b.mouseover(function(){$(this).poshytip("hide");});}else{for(var a=0;a<b.length;a++){temp=JSON.parse(JSON.stringify(b.eq(a))).selector;$(b.eq(a)).bind("keyup",{data:temp.toString()},function(f){return Validata_(f.data.data,e,d);});$(b.eq(a)).bind("mouseover",function(f){$(this).poshytip("hide");});ValidateRulaClass_instance_.init(e);ValidataClass_instance_.add(b.eq(a),ValidateRulaClass_instance_.toString(),d);}return;}}else{$("#"+b).keyup(function(){return Validata_(b,e,d);});$("#"+b).mouseover(function(){$(this).poshytip("hide");});}}else{if(typeof(b)=="object"){if(b.length==1){$(b).bind(c,function(f){return Validata_(b,e,d);});if(c!="mouseover"){$(b).bind("mouseover",function(){$(this).poshytip("hide");});}}else{for(var a=0;a<b.length;a++){temp=JSON.parse(JSON.stringify(b.eq(a))).selector;$(b.eq(a)).bind(c,{data:temp.toString()},function(f){return Validata_(f.data.data,e,d);});if(c!="mouseover"){$(b.eq(a)).bind("mouseover",function(){$(this).poshytip("hide");});}ValidateRulaClass_instance_.init(e);ValidataClass_instance_.add(b.eq(a),ValidateRulaClass_instance_.toString(),d);}return;}}else{$("#"+b).bind(c,null,function(f){return Validata_(b,e,d);});if(c!="mouseover"){$("#"+b).bind("mouseover",function(){$(this).poshytip("hide");});}}}ValidateRulaClass_instance_.init(e);ValidataClass_instance_.add(b,ValidateRulaClass_instance_.toString(),d);}function poshytip_clean_(a){a=getObj_1(a);a.find(":input").poshytip("hide");}function validata_all_(){var f=true;var a=true;var b=$(window),k={l:b.scrollLeft(),t:b.scrollTop(),w:b.width(),h:b.height()};var d=JSON.parse(ValidataClass_instance_.toString());for(var h=0;h<d.length;h++){var c="";for(var g=0;g<d[h].rules.length;g++){if(g>0){c+=";";}c+=d[h].rules[g].ruleName+":";if(!isNull(d[h].rules[g].param)){c+=d[h].rules[g].param+":";}if(!isNull(d[h].rules[g].msg)){c+=d[h].rules[g].msg+":";}if(!isNull(d[h].rules[g].fun)){c+=d[h].rules[g].fun;}}if(d[h].id.indexOf("[")>-1){temp_=d[h].id.split(".");temp__=temp_[1].substr(temp_[1].indexOf(",")+1,temp_[1].length-temp_[1].indexOf(",")-2);obj_1=$(temp_[0]).slice(temp__-1,temp__);try{var m=Validata_(obj_1,c,d[h].title);}catch(l){}if(!isNull(m)){if(f&&obj_1.offset().left>k.l+k.w||obj_1.offset().left<k.l||obj_1.offset().top<k.t||obj_1.offset().top>k.t+k.h){$(document).scrollLeft(obj_1.offset().left);$(document).scrollTop(Math.max(0,obj_1.offset().top-10));f=false;}poshytip_init_(obj_1,m);obj_1.poshytip("show");a=false;}}else{try{var m=Validata_(d[h].id,c,d[h].title);}catch(l){}if(!isNull(m)){if(f&&$("#"+d[h].id).offset().left>k.l+k.w||$("#"+d[h].id).offset().left<k.l||$("#"+d[h].id).offset().top<k.t||$("#"+d[h].id).offset().top>k.t+k.h){$(document).scrollLeft($("#"+d[h].id).offset().left);$(document).scrollTop(Math.max(0,$("#"+d[h].id).offset().top-10));f=false;}poshytip_init_(d[h].id,m);$("#"+d[h].id).poshytip("show");a=false;}}}return a;}